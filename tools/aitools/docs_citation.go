package aitools

import (
	"context"
	"encoding/json"
	"io"
	"log"
	"mensadb/tools/env"
	"strings"

	"github.com/pocketbase/pocketbase/tools/filesystem"
	"google.golang.org/genai"
)

type DocumentCitation struct {
	ID   string `json:"id"`
	Name string `json:"name"`
}

type DocumentsCitationList []DocumentCitation

func (dcl DocumentsCitationList) RetrieveIDs() []string {
	ids := []string{}
	for _, doc := range dcl {
		ids = append(ids, doc.ID)
	}
	return ids
}

type documentsCitationResponse struct {
	Items []DocumentCitation `json:"documents_list"`
}

const provaPrompt = `{"items":[{"id":"g54xjt46200jv5n","name":"AnalisiSviluppoMensaItalia.pptx"},{"id":"7ikelis3bw5g6uy","name":"Linee_Guida_Consiglio_2015.pdf"},{"id":"2xuqm8cp5tfzhxe","name":"Linee_Guida_Consiglio_2013.pdf"},{"id":"z6335u3421m2260","name":"Linee_Guida_Consiglio_2011.pdf"},{"id":"b4s84qo6c603e5e","name":"LineeGuidaConsiglio2009.pdf"},{"id":"8282j49fkr4rydz","name":"LineeGuidaConsiglio2007.pdf"},{"id":"kh0tvgho9r8m5g6","name":"Lineeguida20052102.pdf"},{"id":"9j5q8pu45qkmwl5","name":"Lineeguida20042007.pdf"},{"id":"xi7cb738fdqpdep","name":"Feedback_questionari_candidati.pdf"},{"id":"5408v9345u8q2zp","name":"StoricoElezioniMensa.xls"},{"id":"79bt1kbnrloy81z","name":"20170408_ASIE-Mensa-Italia.pdf"},{"id":"8pv2qrh1ri8i2fu","name":"saldi_set_16.zip"},{"id":"4gsxa33bf59qn3u","name":"saldi_ott_16.zip"},{"id":"886szfi314t57is","name":"saldi_ott_15.zip"},{"id":"b0d67jp82rc565k","name":"saldi_nov_16.zip"},{"id":"g8j6mc9sz8x70wj","name":"saldi_nov_15.zip"},{"id":"t37gd53j5q90g89","name":"saldi_mar_16.zip"},{"id":"2b42h0c6dl7560p","name":"saldi_mag_16.zip"},{"id":"ysj1za3zfg7zhq1","name":"saldi_lug_16.zip"},{"id":"3q7z6nbf6fr0hnv","name":"saldi_giu_16.zip"},{"id":"79bk02o2096o19h","name":"saldi_gen_16.zip"},{"id":"z27067krk5685o6","name":"saldi_dic_2015.zip"},{"id":"1i50ia5pyf99za5","name":"saldi_contabili_febbraio_2016.zip"},{"id":"f773kg264svc99t","name":"saldi_contabili_aprile_2016.zip"},{"id":"2e3w88f9ly1ibw8","name":"saldi_ago_16.zip"},{"id":"7k5qwajo49j9581","name":"RID.pdf"},{"id":"m046bekgu54p9o0","name":"Richiesta_Investimento_Fineco.pdf"},{"id":"5b3z36t59lkhs3u","name":"Paypal_2-2018.PDF"},{"id":"lza7mp6lp3ctlak","name":"Paypal_12-2017.PDF"},{"id":"d3c4nk09c77w2e8","name":"Paypal_11-2017.PDF"},{"id":"mawe6q9mtwgwe86","name":"Paypal_10-2017.PDF"},{"id":"zdfmk64y1sqtwpg","name":"Paypal_1-2018.PDF"},{"id":"5007cm30556j7m9","name":"Paypal_09-2017.PDF"},{"id":"e1mea1n5u24o5g7","name":"Paypal_08-2017.PDF"},{"id":"2o5q1004w9by4nn","name":"Paypal_07-2017.PDF"},{"id":"48jicwzqbw2r5t8","name":"paypal_06-17.PDF"},{"id":"68n0ga3tnl48705","name":"paypal_05-17.PDF"},{"id":"2w2p4c14gn9ew8s","name":"paypal_04-17.PDF"},{"id":"nthkny282j8uy06","name":"paypal_03-17.PDF"},{"id":"48olkx7y835y049","name":"parere_commercialista_29_mar_2017.pdf"},{"id":"1cw33n3t1fpij16","name":"Mensa_doc_Firmato.pdf"},{"id":"bqh6xkgvq29v50w","name":"GoogleAdWords.2017.03.pdf"},{"id":"dbx15080pbso48c","name":"GoogleAdWords.2017.02.pdf"},{"id":"508uwp611diq481","name":"GoogleAdWords.2017.01.pdf"},{"id":"fnn95542gh30cmy","name":"GoogleAdWords.2016.12.pdf"},{"id":"uck45g5l61kq1qs","name":"GoogleAdWords.2016.11.pdf"},{"id":"uiqpr1v33774ej1","name":"GoogleAdWords.2016.07.pdf"},{"id":"k6qib93bi9w4911","name":"GoogleAdWords.2016.06.pdf"},{"id":"0q2c04uuo693320","name":"GoogleAdWords.2016.05.pdf.pdf"},{"id":"j97x5tm6i2kztz1","name":"GoogleAdWords.2016.04.pdf"},{"id":"6vz52hh83uczu2l","name":"GoogleAdWords.2016.03.pdf"},{"id":"g8g2753lc6dquk1","name":"GoogleAdWords.2016.02.pdf"},{"id":"73pqd051m5tgw6f","name":"GoogleAdWords.2016.01.pdf"},{"id":"4t9qwm8heatn43k","name":"GoogleAdWords.2015.12.pdf"},{"id":"18ywf1dpho1y6w8","name":"GoogleAdWords.2015.11.pdf"},{"id":"38j8hp892ql7y0e","name":"GoogleAdWords.2015.10.pdf"},{"id":"z97845687wj1zs9","name":"Fineco_IV_trim_2017.pdf"},{"id":"nodqurie4hfhl5p","name":"Fineco_II_Trim.pdf"},{"id":"3bu1ly35d3q2k97","name":"Fineco_III_trim_2017.pdf"},{"id":"9tvis1uwk84etsf","name":"ec_2016.zip"},{"id":"u473k7tj0avi8c3","name":"DETTAGLIO_CONTABILITA_2009.zip"},{"id":"0t66809a09wk00b","name":"DETTAGLIO_CONTABILITA_2008.zip"},{"id":"52060322jp96z7m","name":"DETTAGLIO_CONTABILITA_2007.zip"},{"id":"au2w318jb3ma3t2","name":"DETTAGLIO_CONTABILITA_2006.zip"},{"id":"0k2g78q09db8blg","name":"DETTAGLIO_CONTABILITA_2005.zip"},{"id":"d6sy6w9o7p444ex","name":"delibere_tesoreria_-_ottobre_2015.pdf"},{"id":"f9erg02uedyn7qi","name":"contabilit_2016.zip"},{"id":"9fhmheqgq284pm2","name":"Contabilita_2014_totale.zip"},{"id":"47y5r73bo0350g7","name":"Contabilita_2013_totale.zip"},{"id":"u4bdg51lw350f25","name":"Contabilita_2013_1tr.zip"},{"id":"0sp12yz4xy0t518","name":"Contabilita_2012_totale.zip"},{"id":"k32gl8a249cwje6","name":"Contabilita_2012_1tr.zip"},{"id":"2ggk13nwal3s73q","name":"Contabilita_2012_1sem_3tr.zip"},{"id":"7q937383m4j9jcg","name":"Contabilita_2012_1sem.zip"},{"id":"2xw9tp607i086j0","name":"Contabilita_2011_totale.zip"},{"id":"k10jm641411q869","name":"Contabilita_2011_1tr.zip"},{"id":"ybqxjyrk840pg23","name":"Contabilita_2011_1sem_3tr.zip"},{"id":"z7fu3z42kij1zi2","name":"Contabilita_2011_1sem.zip"},{"id":"7a06580651vxh5e","name":"1_2017.pdf"},{"id":"x4tqxtgyxcx63sc","name":"20091205_Consiglio.pdf"},{"id":"gh6l7lc619do424","name":"20090503_Consiglio.pdf"},{"id":"w4pk495b981q4v7","name":"20090502_Consiglio.pdf"},{"id":"g965h9238d6bd5b","name":"20081005_Consiglio.pdf"},{"id":"2oi2i4f09vn243a","name":"20080504_Consiglio.pdf"},{"id":"d38oln2bqvbuf8k","name":"20071202_Consiglio.pdf"},{"id":"85812zo55t4fcog","name":"20070623_Consiglio.pdf"},{"id":"0s3sa7m7mn7t885","name":"20070427_Consiglio.pdf"},{"id":"84985gd28z046m8","name":"20061118.pdf"},{"id":"7qu2286761a2jw1","name":"20060625.pdf"},{"id":"41287jlx53acj51","name":"20060421.pdf"},{"id":"765yn6173z09c38","name":"20060212.pdf"},{"id":"jumj97712047mw2","name":"20051112.pdf"},{"id":"2uhjncw7c766s4q","name":"20050703.pdf"},{"id":"9v2t349990uk2pc","name":"20050422.pdf"},{"id":"edj7d061f5h4f75","name":"20050213.pdf"},{"id":"8k1s5wxq89uq339","name":"20041411.pdf"},{"id":"78n5iu7pb940c9t","name":"20040718.pdf"},{"id":"bdm8fs81h1z5iab","name":"20040430.pdf"},{"id":"1t4t4i10eppj7jl","name":"20040215.pdf"},{"id":"6nx0hmn1p719nn4","name":"20031129.pdf"},{"id":"6253fhe12jqj55n","name":"20030706.pdf"},{"id":"ghb0tzpa8820155","name":"20030504.pdf"},{"id":"89t3xzfeski8771","name":"20030209.pdf"},{"id":"6t370eg87802p4x","name":"20021124.pdf"},{"id":"35537ilefx39wb1","name":"20020914.pdf"},{"id":"px9mbbk390314sb","name":"20020518.pdf"},{"id":"77dxui7l8547p52","name":"20020224.pdf"},{"id":"55a5145u83h891o","name":"20011118.pdf"},{"id":"bq5mh9vlhhc9ee0","name":"20011028.pdf"},{"id":"0y2q7o5l53qo9l1","name":"20010902.pdf"},{"id":"t169c367uz272kh","name":"20010527.pdf"},{"id":"d9ml50j60m76108","name":"20010225.pdf"},{"id":"d0824125pxu85y9","name":"LeafletStandardOff.pdf"},{"id":"89t8vtkt589zt34","name":"Informativa consenso Cand Test Ammissione Lug18"},{"id":"16tcxb1f5lj16cm","name":"Informativa consenso Cand Test Ammissione Mag18"},{"id":"523h371345pw165","name":"Dich. Per gli incaricati del tratt dati personali"},{"id":"4126xe4rj87635t","name":"SegnalibriA4.pdf"},{"id":"uk55e7ivi2w2t5a","name":"LocandinaMensaDEF.pdf"},{"id":"t9uj63o0g77vo2w","name":"vettoriali_copertina_mensa_senza_crocini.pdf"},{"id":"tgz43g46ab3jykz","name":"vettoriali_copertina_mensa.pdf"},{"id":"37orp4w39tp3e1j","name":"MIL2017_Ballot.pdf"},{"id":"9v0w9834aqhs6qn","name":"MIL2015_ListOfCandidates.pdf"},{"id":"ydu37yh3jl6av3a","name":"MIL2015_CandidatesStatements.pdf"},{"id":"iwhi04fbr2v2ph9","name":"MIL2015_Ballot.pdf"},{"id":"f784i08zwlfw6hd","name":"MIL2013_VotingInstructions.pdf"},{"id":"tw25nf2hqm25w6f","name":"MIL2013ListOfCandidatesAndConstitutionalReferenda"},{"id":"05iq225kzdy89xw","name":"MIL2013_EnvelopeTemplate.doc"},{"id":"s8z4os3s2971n3j","name":"MIL2013_CandidateMaterials.pdf"},{"id":"498u02v5l52wj66","name":"MIL2013_Ballot.pdf"},{"id":"11d5e0vg45ulmrl","name":"MIL2009_notice_inviting_nominations.pdf"},{"id":"zc90g27936gcq4e","name":"MIL2007scheda.pdf"},{"id":"zi4z5fv5ncfvy7q","name":"MIL2007busta.pdf"},{"id":"36bxuz04j2xv84w","name":"Istruzioni2013.pdf"},{"id":"nf0qg51zd3eze8i","name":"InvitoCandidatureCdG2007.pdf"},{"id":"rmv48w22e82i08m","name":"FascicoloMensaIntern.pdf"},{"id":"1roon9679jt11dg","name":"EstrattoMemento.pdf"},{"id":"4aluz1wya6ag1ry","name":"Elezioni2007.pdf"},{"id":"o0h87xs4ua7v6e6","name":"Consultazioni_2006_testo.pdf"},{"id":"n4h5nwuw0u6ms86","name":"Consultazioni_2006_scheda.pdf"},{"id":"kb04sx86e1kc4jk","name":"CDG-RichCand.pdf"},{"id":"9o8ros3kv27zv4d","name":"CandidatureCdG2014.pdf"},{"id":"x32079dq4z7a8m1","name":"2017_EnvelopeTemplate.pdf"},{"id":"h147s0bl2i0305o","name":"VerbaleElezioni2007.jpg"},{"id":"5h3tgoek1656lqg","name":"VerbaleElezioni14.5.11.pdf"},{"id":"0ivg162n3795z7j","name":"VerbaleElezioni14.4.13.pdf"},{"id":"59cwtbneaqdnjmd","name":"StoricoElezioniMensa.xls"},{"id":"5n6mw7u94331sn6","name":"Schede-Buste.pdf"},{"id":"s9u5m8k85so3mm5","name":"Scheda_voto_CDG_2012.pdf"},{"id":"xhh10t8y9i2cilm","name":"Scheda2013.pdf"},{"id":"yd52056jl401f7j","name":"scheda-sito.pdf"},{"id":"tb2ku05y7l3a8fy","name":"VerbaleReferendum_ElezioneCdG_26.5.12.pdf"},{"id":"32b74c0en034sno","name":"VerbaleReferendum14ott06.jpg"},{"id":"640oda0qltk9k89","name":"VerbaleReferendum14.5.11.pdf"},{"id":"7fh154c324o0986","name":"VerbaleReferendum11feb06.jpg"},{"id":"hjm0ia18ww78118","name":"VerbaleElezioni2015ConsiglioNazionale.pdf"},{"id":"9f5z50d8p7i2833","name":"Referendum_2012_Istruzioni.pdf"},{"id":"o1l95xar0y0rr9o","name":"ProrogaRefIta.pdf"},{"id":"sv862188z583grk","name":"Proposta_di_modifiche_statutarie_2017.pdf"},{"id":"5br3vfd2pf3p0m2","name":"ProgrammiCandidatiCDG2012.pdf"},{"id":"02nyv95jdwz9yju","name":"Presentazioni2015.pdf"},{"id":"u6qost9kt9j3lul","name":"Presentazioni2013.pdf"},{"id":"yb48qq6bv6jxi5d","name":"PresElez2009.pdf"},{"id":"rs7f37b5x8bd0io","name":"OffAppForm2010.doc"},{"id":"2nd00kl0jmjq872","name":"Notice_of_International_Election_2017.doc"},{"id":"965m88y1am49am3","name":"NOTICE_OF_INTERNATIONAL_ELECTION_2013.pdf"},{"id":"5ff7r8p1v092bn4","name":"MIL2017_VotingInstructions.pdf"},{"id":"6zcjxv4rvh0erx1","name":"MIL2017_ListOfCandidates.pdf"},{"id":"60t6gsf3a7b5y60","name":"MIL2017_EnvelopeTemplate.pdf"},{"id":"d281a0i177upyp4","name":"Verbale Elezioni Consiglio1999"},{"id":"s04dk5j8h8049bi","name":"Verbale Elezioni Consiglio2001"},{"id":"5sr4q2uc6c3e70h","name":"Verbale Assemblea 2002 Palermo"},{"id":"znec9e3o2n4uwu1","name":"Verbale Assemblea 2003 Jesolo"},{"id":"4229n1ne928ek26","name":"Verbale Elezioni Consiglio2004"},{"id":"5fxn5xxl9n69qy7","name":"Verbale Assemblea 2004Tirrenia"},{"id":"91il3p741shumv3","name":"Regolamento Ombudsman"},{"id":"uw61hj1uz1tploj","name":"DPS Documento Progr. Sicurezza"},{"id":"8kg58k5q71kkfxu","name":"Delibera_attiv_giudice_2004.pdf"},{"id":"7pte0t5rdog3246","name":"relazione_annuale_giudice_2004.pdf"},{"id":"he03q8t0pg35j7i","name":"proposta_soluzione_mazza_capannolo_30.01.2005.pdf"},{"id":"4o33vtb7619r2xm","name":"relazione_mazza_capannolo_19.02.2005.pdf"},{"id":"7buiz02w94mp918","name":"Verbale Assemblea 2005"},{"id":"23e7g421kffg4yl","name":"DenunciaBuzzivsAC.pdf"},{"id":"h43wsmpt780m506","name":"proposta_soluzione_buzzi_corradini24072005.pdf"},{"id":"239362qenb78am1","name":"Delibera_attiv_giudice_2005.pdf"},{"id":"j11i7ddfhom5o2s","name":"relazione_buzzi_corradini_27082005.pdf"},{"id":"vr0bv886n4s317v","name":"Rapporto del Consiglio AG 2006"},{"id":"9c0271ba10n586m","name":"Verbale Assemblea 2006 Milano"},{"id":"w5au8xyoyq646av","name":"Parere_GiudiceFontanellaSolimena.pdf"},{"id":"836liixo26x5tru","name":"Verbale Assemblea 2007 Spoleto"},{"id":"iwe1m59rkp1t9qe","name":"Delibera CdG 2008.02"},{"id":"2h17a872gopdc05","name":"Delibera CdG 2008.01"},{"id":"7vr2mgx9h1tn54s","name":"Delibera CdG 2008.03"},{"id":"648jjtlnc6mfd8o","name":"Delibera CdG 2008.04"},{"id":"2y8iuu8pu656815","name":"Bilancio 2006"},{"id":"osoo2ou2klx3a10","name":"Delibera CdG 2008.06"},{"id":"d9z4cyb0x128ri0","name":"Delibera CdG 2008.05"},{"id":"6pu0o21h1x05xh0","name":"Delibera CdG 2008.07"},{"id":"rza8d6oh53jntdf","name":"Bilancio 2007"},{"id":"33le65mzl0q686m","name":"SIGHT Traveller Registration"},{"id":"0h6aced1qnhu61u","name":"Verbale Assemblea 2008"},{"id":"94578u5c6pdhu16","name":"Verbale Elezioni Consiglio2009"},{"id":"2l518a6hf130830","name":"Bilancio 2008"},{"id":"m9o4m2q2g1f8htn","name":"Verbale Assemblea 2009 Genova"},{"id":"8gf9g063t44ym6q","name":"Verbale Assemblea 2010 Trani"},{"id":"eg330ec0g82nee3","name":"Riunione Consiglio 2.5.2010"},{"id":"45h43lg24813r9w","name":"Verbale Assemblea 2010 Milano"},{"id":"45397t92nh963d4","name":"Verbale III Assemblea 2010 "},{"id":"j375r9hjw7by286","name":"Riunione Consiglio 21.11.2010"},{"id":"x38f9m3fxz970zs","name":"Riunione Consiglio 19/12/2010"},{"id":"39f4d84l3io7h6g","name":"Vademecum Organizzaz. Convegni"},{"id":"xjl83a3o691c82z","name":"Bilancio 2010"},{"id":"95i4h6h42bj78sz","name":"Riunione Consiglio 15.5.2011"},{"id":"qnkz54u4jnmuepz","name":"Verbale Assemblea 2011 AQ"},{"id":"zonm57b1l746apo","name":"Riunione Consiglio 4.6.2011"},{"id":"3j2729r2y9q13zh","name":"Riunione Consiglio 5.6.2011"},{"id":"4p78fz1l5k4x259","name":"Riunione Consiglio 24.07.2011"},{"id":"m1bqrj9kl99c95l","name":"Riunione Consiglio 28.10.2011"},{"id":"7o2ne0376l7h106","name":"Verbale Assemblea 2011 Roma"},{"id":"1zcxf919kkgvo02","name":"Riunione Consiglio 2.11.2011"},{"id":"hy5ibc6rfv3p60n","name":"Riunione Consiglio 21.1.2012"},{"id":"ybrm2961qlzr4i6","name":"Delibera CdG 2012.01"},{"id":"3pus8w784bydf40","name":"Delibera CdG 2012.02"},{"id":"3im29ejv05qfx75","name":"Verbale Assemblea 2012 Milano"},{"id":"9588hva22gm29o1","name":"Riunione Consiglio 28.4.2012"},{"id":"biyq5l9p5xgwny9","name":"ASIE Mensa International trad."},{"id":"5hh0j3j5rco453k","name":"ASIE Mensa International + FAQ"},{"id":"0d44882w2g8qet7","name":"Riunione Consiglio 8.12.2012"},{"id":"3rjd23g18q73ego","name":"Riunione Consiglio 19.1.2013"},{"id":"njqx846jw3005xi","name":"Riunione Consiglio 4.4.2013"},{"id":"puzjikjitmy752z","name":"Poster per i 30 anni del Mensa Italia (1983-2013)"},{"id":"f59u9qdw977t8mg","name":"Riunione Consiglio 26.4.2013"},{"id":"7047njlx00ne72k","name":"Verbale Assemblea 2013 Palermo"},{"id":"el3h62yknx16702","name":"Riunione Consiglio 9.6.2013"},{"id":"2icq29dk3s83156","name":"Riunione Consiglio 31.8.2013"},{"id":"zn090svpq5q1waq","name":"Ricorso CdG 2013.01"},{"id":"18c37kk753qqspt","name":"Riunione Consiglio 30.11.2013"},{"id":"f8yls5yluh4nprj","name":"Delibera CdG 2013.01"},{"id":"8s736z599pyzu97","name":"Riunione Consiglio 2.3.2014"},{"id":"9188fy3fclpf94h","name":"Rapporto del Consiglio AG 2014"},{"id":"95705i8uq7r07oi","name":"Verbale Assemblea 2014 RE"},{"id":"s82uqcd1r25p7r9","name":"Riunione Consiglio 26.4.2014"},{"id":"y706m76w98x3a96","name":"Dimissioni Presidente Buzzi"},{"id":"any552nbo3lx727","name":"Riunione Consiglio 14.6.2014"},{"id":"vc894nxz54pk0oi","name":"Riunione Consiglio 8.11.2014"},{"id":"5sa17b42d02g17v","name":"Regolamento Cdg 2014"},{"id":"0334z554r117q2s","name":"Riunione Consiglio 28.3.2015"},{"id":"50wrh8g6drd2c6m","name":"Regolamento Cdg 2015"},{"id":"pc414dsug9skosg","name":"Riunione Consiglio 1.5.2015"},{"id":"s3rftpina937a07","name":"Rapporto del Consiglio AG 2015"},{"id":"1799c97c9xn830n","name":"Verbale Assemblea 2015 Gorizia"},{"id":"f871wqt630j9j74","name":"FAQ Assistenti al Test"},{"id":"9x6wn160m80kc7r","name":"Delibera CdG 2015.02"},{"id":"w73frs5al0y3s2y","name":"Delibera CdG 2015.01"},{"id":"d2xzj6z562lg565","name":"Delibera CdG 2015.03 v1.1"},{"id":"43321x06krq8k4c","name":"Riunione Consiglio 17.10.2015"},{"id":"rh5a90k6190n89g","name":"Linee_guida_per_i_rapporti_con_i_media.pdf"},{"id":"ijq2qxa81zj6t2m","name":"Ricorso CdG 2015.04"},{"id":"m597ldbd39gu573","name":"Delibera CDG 2015.04"},{"id":"rreu5kl94j96me8","name":"Riunione Consiglio 15.11.2015"},{"id":"r9rftic1o50xs1e","name":"Riunione Consiglio 30.12.2015"},{"id":"649yvx1g7f709it","name":"Riunione Consiglio 5.1.2016"},{"id":"0330fapxp8qmflc","name":"Linee guida per la retrib attivita professionali"},{"id":"7v6fw1zj155grzj","name":"Bilancio 2015"},{"id":"3rn1ecn544bcx43","name":"Bilancio Preventivo 2016"},{"id":"vv59enl86o6fais","name":"Relazione Bilancio 2015 +Prev"},{"id":"270sq6kva185rfi","name":"Riunione Consiglio 14.3.2016"},{"id":"l1y43b63u70ueqa","name":"Delibera CdG 2016.05"},{"id":"131qp5z6939712p","name":"Delibera CdG 2016.04 v1.1"},{"id":"hpm0ap1z2qb4v40","name":"Delibera CdG 2016.03_v1.1"},{"id":"ys1mm52ut7guv59","name":"Delibera CdG 2016.02"},{"id":"k8cx03pz3g3sd01","name":"Delibera CdG 2016.01"},{"id":"9f91wxsm7s11052","name":"Ricorso CdG"},{"id":"964mzolo8fyln4w","name":"Rapporto del Consiglio AG 2016"},{"id":"iu225b3c2872dv8","name":"Verbale Assemblea 2016 Taranto"},{"id":"89xvtgc1up0h881","name":"Riunione Consiglio 23.4.2016"},{"id":"pc2r5uzgu8u12c2","name":"Ricorso CdG 2016.03"},{"id":"dh44436ino6ph7r","name":"Riunione Consiglio 03.06.2016"},{"id":"w4wo8tt7pjc44n7","name":"tracciamentodeibeniassociativi.pdf"},{"id":"t7zofzu7g8k5vup","name":"Delibera CdG 2016.06"},{"id":"j77rm056r156thx","name":"Delibera CdG 2016.03"},{"id":"8fa432uc4jzpt88","name":"Riunione Consiglio 5.11.2016"},{"id":"yxvme203wf79f04","name":"Delibera CdG 2016.07"},{"id":"bl01nd2t263frmu","name":"Linee-guida Consiglio2017-2019"},{"id":"a6o2pbcs8zu41lj","name":"Delibera CdG 2015.04_mod"},{"id":"7619tvncvxuv58b","name":"Delibera CdG 2016.08"},{"id":"aijr80mx6op6611","name":"Carteggio Michieli vs di Fonzo"},{"id":"262p068js34y081","name":"Memento 1"},{"id":"mhyacnaxoeke637","name":"Riunione Consiglio 9.1.2017"},{"id":"690i1ixhf0hz30q","name":"Memento 2"},{"id":"ie3n3xbp05o8p4q","name":"LineeGuidaPerIGruppiLocali.pdf"},{"id":"x9am14t1df85q42","name":"Analisi risultati Brain 2016"},{"id":"ab55e5lmx4025j4","name":"Riunione Consiglio 18.2.2017"},{"id":"d47h25b7599bk04","name":"Relazione Bilancio 2016 +Prev "},{"id":"igwmmd31n9651e6","name":"Bilancio 2016 + Budget 2017"},{"id":"1h06v4u459u112b","name":"Verbale Referendum 2017"},{"id":"8a6goc31xol3391","name":"Regolamento dei Gruppi Locali"},{"id":"77p8djiqg1h4kg3","name":"Memento 3"},{"id":"v6el8bkowgz16l8","name":"ASIE Mensa Italia"},{"id":"41108vdzta0xgoc","name":"Delibera CdG 2016.09"},{"id":"7xv1smr1mw5b9vb","name":"Delibera CdG 2017.01"},{"id":"odf1o9365wj6f3d","name":"Progetto Boutique 2015"},{"id":"4qs00y5za66hb2s","name":"Linee guida pubbl eventi delle segr area pubblica"},{"id":"okay94ae6af83ou","name":"Riunione Consiglio 7.4.2017"},{"id":"8h3b8x50994c98r","name":"Compendio Regolamenti assoc."},{"id":"8xr1y1l09y2q03m","name":"PresentazioneCandidatiMIL2017 "},{"id":"g63yz6g3qq8wpfz","name":"parere tenuta libri contabili"},{"id":"vs8qvjzsny8f358","name":"Verbale Elezioni Consiglio2017"},{"id":"im7x2ps62u80tu1","name":"Riunione Consiglio 22.4.17"},{"id":"w8c237oftm82v9q","name":"Rapporto del Consiglio AG 2017"},{"id":"xl2pirjmi21cee6","name":"Verbale Assemblea 2017 Latina"},{"id":"nsw228i882p0pis","name":"Riunione Consiglio 2.5.2017"},{"id":"jenjg9by1n20t1i","name":"Delibera CdG 2017.02"},{"id":"9x806d9804af655","name":"Riunione Consiglio 15.5.2017"},{"id":"ck3wv4151lwo9eq","name":"Conto Economico 01/2017"},{"id":"1k714t7t086v8y6","name":"Stato Patrimoniale 01/2017"},{"id":"b553z38e0979nx1","name":"Delibera CdG 2017.06 - Rif.4"},{"id":"tsph2d13h1937w1","name":"Delibera CdG 2017.05 -allegato"},{"id":"57x12e1gy841e90","name":"Delibera CdG 2017.04 -allegato"},{"id":"54p8513kjb972w9","name":"Delibera CdG 2017.03 - rif.4"},{"id":"co27k07whs79092","name":"Ricorso Cdg 2017.03 -allegato"},{"id":"yoit5ro50i4jve2","name":"Delibera CdG 2017.06 - Rif.5"},{"id":"jb45e2wa22b82zu","name":"Delibera CdG 2017.06"},{"id":"2m9t914643g4yx9","name":"Delibera CdG 2017.05"},{"id":"z11lq4xoj778c7p","name":"Delibera CdG 2017.04"},{"id":"ynoho7u3313box8","name":"Delibera CdG 2017.03"},{"id":"r7onev9zn178d3l","name":"Riunione Consiglio 29.5.2017"},{"id":"097cmjyh25622av","name":"Istruzioni per Elenco Soci"},{"id":"g6x83oe973io31i","name":"Riunione Consiglio 18.6.2017"},{"id":"q7577252pt5bkve","name":"Riunione Consiglio 21.6.2017"},{"id":"861574rfq3s3t42","name":"Linee-guida rimborsi e budget"},{"id":"607yg956797stfj","name":"Delibera CdG 2017.06 -allegato"},{"id":"e7f46im9694t3ak","name":"Regolamento dei SIG"},{"id":"x2ny92r3220g97v","name":"Riunione Consiglio 12.7.2017"},{"id":"j3c7j68772qo6ij","name":"Linee-guida nomina degli AATT"},{"id":"80iioz0rsd9h4zp","name":"Fineco II trimestre 2017"},{"id":"m964k3858kl3140","name":"Delibera CdG 2017.07 - rif.4"},{"id":"q46ct62yq8gr3o7","name":"Delibera CdG 2017.07 - rif.3"},{"id":"47e29iljb1ck379","name":"Delibera CdG 2017.08"},{"id":"21u33534t1988q7","name":"Delibera CdG 2017.07"},{"id":"x54nl2f1ncc4575","name":"Riunione Consiglio 29.8.2017"},{"id":"11dt48wa0bx3jdn","name":"Riunione Consiglio 12.9.2017"},{"id":"257ptr0q9h68jjz","name":"Riunione Consiglio 26.9.2017"},{"id":"o8j4d1mj195g363","name":"Delibera CdG 2017.09"},{"id":"8izeodx4c4m9m0b","name":"Riunione Consiglio 14.10.2017"},{"id":"jt476qu485379a5","name":"Verbale Riunione delle Segreterie, Pescara 2017"},{"id":"596s4i4u709ftv6","name":"Riunione Consiglio 14.11.2017"},{"id":"m740t6l7740fu5c","name":"Riunione Consiglio 2.11.2017"},{"id":"8pjiso7eze3ajjv","name":"Riunione Consiglio 30.11.2017"},{"id":"30te7fosr6c14sc","name":"Referendum 2017-12 Verbale"},{"id":"1w4pfqz42b32ai2","name":"Delibera CdG 2018.01"},{"id":"g6j2mp2mft1da5t","name":"Delibera CdG 2017.10"},{"id":"5t6280bnr540g2a","name":"Delibera CdG 2018.02"},{"id":"8y37ftz7qfwe7l3","name":"Delibera CdG 2018.03"},{"id":"73563822rr95a8c","name":"Delibera CdG 2018.02 -allegato"},{"id":"qlllx5ye9g8jpp1","name":"Riunione di Consiglio 8.1.2018"},{"id":"bwg07ua4x0dnx68","name":"Riunione Consiglio 25.1.2018"},{"id":"b4458kgqv24stb8","name":"Contabilit√É  2017"},{"id":"3qv4czgadui9w44","name":"Relazione contabile 2017 + preventivo 2018"},{"id":"0bb58h6s830t25g","name":"Bilancio 2017 - Preventivo 2018"},{"id":"0u24yz7a264g495","name":"Referendum modif. Statuto 2018"},{"id":"8bp6pt9huba6sl0","name":"Referendum 2018-03 Testo Modif"},{"id":"1i4yil5c3913uyv","name":"Referendum 2018-03 Comitato NO"},{"id":"49qy3w1zt1zbbjv","name":"Riunione di Consiglio 2.3.2018"},{"id":"fvdf49w4tf026yk","name":"Riunione di Consiglio 7.3.2018"},{"id":"f2n9j4ll8pcy2bi","name":"Riunione di Consiglio 9.4.2018"},{"id":"qwa05q308omyejj","name":"Rapporto del Consiglio AG 2018"},{"id":"5y375kme7z65485","name":"Verbale Assemblea 2018 Torino"},{"id":"b646167n40uj42j","name":"Riunione di Consiglio 9.5.2018"},{"id":"3p0s092cojuf6j4","name":"Regolamento CdG 2018"},{"id":"1wmj579kx304s3i","name":"Delibera CdG 2018.04"},{"id":"d62gz5i62js6920","name":"Informativa e consenso Relatore"},{"id":"dgm0sq51d16v6p9","name":"Lettera Assunzione respon Assistenti test LUG18"},{"id":"dz5587r35s648c1","name":"Delibera CdG 2018.05"},{"id":"601pozuh7490gmm","name":"Scheda Premi e Punteggi Mensa Coin 2018"},{"id":"ys9ys004anm3r23","name":"Regolamento Mensa Coin 2018"},{"id":"n19g1ob4544fg31","name":"Calendario storico degli eventi nazionali"},{"id":"h84lctv8y3n9v61","name":"Riunione di Consiglio 26.7.18"},{"id":"389z0z15tm2a40l","name":"Guida nuova procedura AT"},{"id":"4gt47lm6m34v6k2","name":"Istruzioni prenotazione test"},{"id":"89wajae6eojyh4n","name":"Prossimo evento del Mensa ER"},{"id":"x82116b301ezqz3","name":"Informativa Privacy x conferenza PUBBLICA"},{"id":"5lig410snzlmz77","name":"Lettera di Incarico per conferenzieri"},{"id":"22o5941e2d3i261","name":"Referendum ottobre 2018 - testo"},{"id":"826zuju4v5t6154","name":"Istruzioni per l'accesso al MIOG"},{"id":"7fw4fa60i92t44h","name":"Elenco Ufficiale dei Gruppi Locali"},{"id":"07l22464bbl6k3h","name":"Riunione di Consiglio 8.9.2018"},{"id":"69e0bj9c3n44civ","name":"Verbale Riunione delle Segreterie, Firenze 2018"},{"id":"jabmifk4120y1de","name":"Nota Commercialista sul Terzo Settore"},{"id":"857ykb5qh250ex6","name":"Riunione di Consiglio, Firenze 27/10/2018"},{"id":"fz28r4ft6oagxt8","name":"Verbale spoglio Referendum 2018-10"},{"id":"7s30q8dxz5c85v1","name":"Delibera CdG 2018-06"},{"id":"hz9fwc6q6541560","name":"Elenco dei SIG"},{"id":"3z9g449ko16e07r","name":"mansioni del tesoriere settembre 2018"},{"id":"vsl381p5lx50fm0","name":"custodia beni associativi"},{"id":"8x41is11m51vs5q","name":"dichiarazione incaricati al trattamento dati"},{"id":"zmu83861qe24par","name":"Delibera_CdG-2018-07"},{"id":"75z95ooo13tyc2t","name":"Regolamento MIOG valido dal 17 gen 2019"},{"id":"lo2q1keijrhw216","name":"Riunione Consiglio 10.12.2018"},{"id":"100o65dsrev2c4x","name":"Delibera_CdG_2019-01_v1_0"},{"id":"ta08x3lt24pl679","name":"centri di costo e prime note 2018"},{"id":"8kugwf085468ym6","name":"saldi bilancio 2018 e budget 2019"},{"id":"89g51mi67vk6ml1","name":"relazione sul bilancio 2018 e preventivo 2019"},{"id":"n9uy35a9q72um0i","name":"Riunione Consiglio 14.1.2019"},{"id":"3rejen686t5745q","name":"Relazione Area32 tentativi di intrusione"},{"id":"uvir20o4a9415f1","name":"Riunione Consiglio 4.3.2019"},{"id":"a1kwgbv6w3t0zdb","name":"Delibera CdG 2019-02 Da Ronche vs Consiglio"},{"id":"4f0i493o8tj1nhj","name":"Delibera CdG 2019-03"},{"id":"0j5cr78slzmidl7","name":"Verbale Elezioni CdG 2019-04-01"},{"id":"e267wqn70sk45a0","name":"Delega Assemblea 2019-04-13 Napoli"},{"id":"39y5rvsyewstasb","name":"Adeguamenti Mensa Internazionale 2019"},{"id":"6806b0ka4kr626l","name":"Elezioni Mensa Internazionale 2019"},{"id":"033561ffkwn83af","name":"TestoRicorsoMore-"},{"id":"80x487j0v830499","name":"Fissazione Udienza Documentario"},{"id":"1kfc990uq2id791","name":"MENSA FAMILY - 29/30 giugno, Treviso"},{"id":"2g3n1zuo1ke3507","name":"Delibera CdG 2019-04 Pallotti VS Radin"},{"id":"4a6ixyr9602d772","name":"Verbale Assemblea dei Soci 2019 - Napoli"},{"id":"wxai3387d4v064a","name":"Regolamento CdG 2019"},{"id":"35d655u4y8q1958","name":"Regolamento Miog in vigore dal 2019-05-20"},{"id":"9tbg4j332nqgmu1","name":"Delibera CdG 2019-05 Pallotti Vs Patierno"},{"id":"c57x8ah0o5rc58o","name":"Delibera CdG 2019-06 Garofalo Vs Consiglio"},{"id":"21r8t1f5188ca92","name":"Delibera CdG 2019-07 Cioni-Alfano-LogoGayPride"},{"id":"n5nbq1198mm47p3","name":"ASIE - Delibere CdG 2005-2019"},{"id":"n1beaj1skxjs5e1","name":"Delibera CdG 2019-08 Maraziti Vs Sessa"},{"id":"boubt0c9vs4ifym","name":"Contratto Area32"},{"id":"qettotr7l6cm3uq","name":"Riunione Consiglio 4.7.2019"},{"id":"1lxkg2xtc8315oy","name":"Linee Guida per il Consiglio 2019-2021"},{"id":"39rs7j518o37p79","name":"Scheda d'iscrizione MIG 2019"},{"id":"xyxsw48g73273x3","name":"Delibera2019-10SessaVsFerrari"},{"id":"2v12bf76ml94vz1","name":"Delibera2019-09SessaVsCioni-Ferrari-Giudice"},{"id":"3r75ssk1d7kauc0","name":"Istruzioni FB ID"},{"id":"0rm79il5m63ha2r","name":"Presentazioni Candidati 2019"},{"id":"70na0rg9gm77ag1","name":"Delibera CdG 2019-11 Di Fonzo Vs Cioni"},{"id":"5j2g2s93ds6697e","name":"Regolamento CdG - 2019 - v4.1"},{"id":"xh2219487vk59tb","name":"Riunione Consiglio 15.10.2019"},{"id":"2v927q036a7156l","name":"Riunione Consiglio 01.11.2019 "},{"id":"u2tn4111rd0w1ud","name":"Riunione Consiglio 05.11.2019 "},{"id":"8uqf91qg112it60","name":"Delibera CdG 2019-13 Cantoni vs Consiglio "},{"id":"gjpi37768p90aq1","name":"Regolamento CdG - 2019 - v4.11"},{"id":"tsmr145vl7v6fa9","name":"Logo pittogramma (colore) - no marchio registrato"},{"id":"7g01zl7h5rt7a9r","name":"Logo pittogramma (colore)"},{"id":"7p4puw2f5v2xe35","name":"Logo orizzontale (colore) - no payoff"},{"id":"u0kj336316w8250","name":"Logo orizzontale (colore)"},{"id":"42cc8nkyf8uf039","name":"Logo verticale (colore)"},{"id":"038s8574pv67y68","name":"Verbale Riun. Gruppi Locali, 16 nov 2019 Palermo"},{"id":"25607esk935656n","name":"Verbale Elezioni Consiglio 2019"},{"id":"4cclfy9g09m3qip","name":"Nuovo Regolamento per gli Assistenti al Test"},{"id":"5s3ku5630n3jll0","name":"Candidatura A. L. Fantini - GL Lazio 2019"},{"id":"2a44gw3erzw048g","name":"Candidatura Alberta Sestito - GL Lazio 2019"},{"id":"02hbo0ss319zv0x","name":"Delibera CdG 2019-14 Grossini vs Garofalo"},{"id":"33u6b17w030185p","name":"Verbale Assemblea Gruppo Locale Lazio 7/12/2019"},{"id":"7un133ago96y2zk","name":"Analisi risultati Brain 2019"},{"id":"83542u54q008vl0","name":"Riunione Consiglio 25.01.2020 "},{"id":"w90c0o16qklt27q","name":"Tabella Bilanci consuntivo 2019 e preventivo 2020"},{"id":"0b1y48d332heh47","name":"Relazione Assemblea 2020"},{"id":"h5m2u3j6rdmzkvn","name":"Bilancio Consuntivo anno 2019"},{"id":"e4n8606hb4on081","name":"Riunione Consiglio 17.05.2020"},{"id":"7p1130q114x7v40","name":"Protocollo AATT - Regole test durante COVID"},{"id":"1o1hz4hray77ajp","name":"Autodichiarazione normativa antiCOVID test"},{"id":"i61jsgzy18v89k1","name":"Bilancio preventivo 2020 rev."},{"id":"3e1p5r765zie479","name":"Deilbera CdG 2020-01 Maraziti vs Corradini"},{"id":"d02w80o16c8ubv4","name":"Delibera CdG 2019-12 Sessa vs. Cioni"},{"id":"09znh6uf0q561p7","name":"Verbale Assemblea Nazionale 5 settembre 2020"},{"id":"tj8u7cfp4qgn35g","name":"Resoconto IBD Mensa 2020"},{"id":"eh12gnx9fn4vf1z","name":"Presentazione Candidati Comitato di Garanzia 2020"},{"id":"j881b1vc0s4764j","name":"Statuto del Mensa Italia"},{"id":"5k5538pf546s28k","name":"Brain 2020 soci - Regolamento"},{"id":"6ai4fa34e40d71k","name":"Pubblicazioni Storiche Mensa"},{"id":"38i222q3i9300vd","name":"Delibera CdG 2020-05 Consiglio vs. Corradini"},{"id":"4giwbn50jck5l15","name":"Delibera CdG 2020-04 Buzzi vs. Corradini"},{"id":"479b350595x4agl","name":"Delibera CdG 2020-03 Sessa vs. Maraziti"},{"id":"ol5a71z733glm26","name":"Delibera CdG 2020-02 di Fonzo vs. Cantoni"},{"id":"12g640dw8aua9or","name":"Riunione Consiglio 22.12.2020"},{"id":"1ia940j92oqfxix","name":"Nomina autorizzati al trattamento dati"},{"id":"n4pb796s53z0ke3","name":"Bilancio Confronto 2020 vs 2019"},{"id":"70xdj57tt14y0u8","name":"Bilancio 2020"},{"id":"uoo082c1m4mk38v","name":"Relazione Bilancio Consuntivo 2020-Preventivo 2021"},{"id":"xhjc273g66i41hk","name":"Modulo Delega Assemblea Mensa 15 maggio 2021"},{"id":"2x8w89ps9l7do59","name":"Testo mozioni Assemblea 15 maggio 2021"},{"id":"womtv6u45uey1ry","name":"Documentazione progetto Aster"},{"id":"2q28fov30k692n4","name":"Bilancio Preventivo 2021 - singole voci di spesa"},{"id":"gjykl47iq339zv3","name":"Protocollo somministrazione test - 18 maggio 2021"},{"id":"jzt5479gp3ju823","name":"Verbale Assemblea Nazionale 15 maggio 2021"},{"id":"b25t5a2wa5rm4sa","name":"Linee-guida mandato Consiglio 2021-2023"},{"id":"tp5m6nhj072xv9a","name":"Modalita' Elezioni Consiglio 2021"},{"id":"4laqgi250r9au6u","name":"Riunione Consiglio 28.07.2021"},{"id":"tmq527e34006ilk","name":"Autorizzazione genitori per test a minore"},{"id":"4i05m7yvzkmh496","name":"Modulo candidatura nuovo AT - set 21"},{"id":"q2n9a2kxbo6n262","name":"Presentazione Candidati Elezioni 2021"},{"id":"l7446g3a1u58mst","name":"Regolamento Brain soci 2021"},{"id":"06sqikyc6b687un","name":"Verbale elezioni Consiglio 2021"},{"id":"q3x92930f3wlaiu","name":"Modulo delega Assemblea 2022"},{"id":"s2vx3994o314in9","name":"Testo Mozioni Assemblea 2022"},{"id":"26m5b3u08z223r5","name":"Bilancio Consuntivo anno 2021"},{"id":"0k34qf1m5j1wv60","name":"Relazione Bilancio Consuntivo anno 2021"},{"id":"47w299i3dv59tf8","name":"Presentazione Bilancio Preventivo 2022"},{"id":"6z3yme7600hu26n","name":"Struttura Mensa Italia -aggiornamento a maggio '22"},{"id":"06x3qiustw562y0","name":"Regolamento Gruppi Facebook Mensa Italia rev. 2022"},{"id":"095b616fl7o2v2j","name":"Verbale Assemblea Nazionale 30 aprile 2022"},{"id":"763t53414087plp","name":"Riunione Consiglio 09.05.2022"},{"id":"2294x12059zvml2","name":"Regolamento Brain 2022 - soci"},{"id":"f507u36n2b2rp84","name":"Bilancio anno 2022"},{"id":"7khb62y6023vnqi","name":"Verbale Riunione di Consiglio 22 febbraio 2023"},{"id":"7f6cf4va732o4w0","name":"Testo Mozioni Assemblea 2023"},{"id":"x0x9nf31853bpu1","name":"Modulo delega Assemblea 2023"},{"id":"0p518b1t91qlbg2","name":"RELAZIONE BILANCIO CONSUNTIVO ANNO 2022"},{"id":"t3x69w8kl199p17","name":"Verbale Riunione di Consiglio 13 marzo 2023"},{"id":"3av26p3r489r979","name":"Delibera CdG 2023-01 Pallotti vs Vari"},{"id":"3d9139zh7117gdn","name":"Presentazione Preventivo 2023"},{"id":"k1slzqj8d3u3176","name":"Atti del XL Convegno - Firenze 2023"},{"id":"mo9574j0gg14ya2","name":"Linee Guida Consiglio Mensa Italia 2023-25"},{"id":"lc08w37iiz5d9zt","name":"Verbale Riunione di Consiglio 20 luglio 2023"},{"id":"0mkq6fvmq7a68qe","name":"Opuscolo Mensa Italia 2023"},{"id":"07g124y7lg0nuf3","name":"Atti causa Pallotti vs Mensa Italia - second parte"},{"id":"4ew7s8905np165j","name":"Atti causa Pallotti vs Mensa Italia - prima parte"},{"id":"t6bh9ry77ya116m","name":"Delibera CdG 2023-02 Pallotti vs Valerio "},{"id":"78iom6q7j13329g","name":"Elezioni Consiglio Mensa Italia 2023"},{"id":"44r929s26m3nzal","name":"Verbale Assemblea Nazionale 15 aprile 2023"},{"id":"wl6ul91hg50agmv","name":"Linee Guida per Segretari 2023"},{"id":"os1i0snrt7v0l0o","name":"Regolamento Brain 2023 - soci"},{"id":"3k9576wux99o48m","name":"Verbale Riunione di Consiglio 1 novembre 2023"},{"id":"aw2m97869800de4","name":"Regolamento MIOG novembre 2023"},{"id":"71oje95sit1kflq","name":"Verbale Riunione di Consiglio 6 novembre 2023"},{"id":"8354t9br904408n","name":"Verbale Riunione di Consiglio 17 novembre 2023"},{"id":"d75c4l54tuzw1qm","name":"Regolamento Mioc"},{"id":"oqerra4ezgcsv6x","name":"  Delibera CdG n. 2024/01 Di Fonzo Vs Campion "},{"id":"5zv036o3l296931","name":"Delega assemblea 13 aprile 2024"},{"id":"2iwns6807wi10we","name":"Testo mozioni assemblea 13 aprile 2024"},{"id":"82s42mv0py6hbyl","name":"Delibera CDG 2024.02 Chiara Da Ronche vs Cefali"},{"id":"v3njjfd7f06v64i","name":"Linee Guida Rimborsi 2024"},{"id":"4r6mopd7ah9w864","name":"Preventivo 2024"},{"id":"z3wz7y82071li29","name":"Relazione consuntivo 2023"},{"id":"mxxx3p6rh130a1t","name":"Riunione di Consiglio 6 aprile 2024"},{"id":"76ll4uw8725jm00","name":"Bilancio 2023"},{"id":"k7402cz6b7g34j6","name":"Regolamento CDG 2024 v5.00"},{"id":"22kz3l5tgvq4995","name":"Linee Guida Rinnovi 2024"},{"id":"rc8425ta75fw78d","name":"Delibera Cdg2024.04 Sipione vs Gorrino e Montanaro"},{"id":"5a2k5xzr584dv23","name":"Delibera Cdg 2024.03 Bagnara vs Terzo e Consiglio"},{"id":"46i4pws418bv800","name":"Verbale Assemblea Nazionale 13 aprile 2024 "},{"id":"4buxqywx646sef2","name":"Presentazione Candidati Comitato di Garanzia 2024"},{"id":"n7mqpep310hzt6m","name":"Verbale riunione di Consiglio 7-9-2024"},{"id":"26f4210gazac762","name":"Verbale riunione Sig 12-09-24"},{"id":"wi24h10qdzexty6","name":"Regolamento e istruzioni Brain 2024"},{"id":"0ojy6g163x8sz2v","name":"Delibera Cdg 2024.05 Vezzani Vs Consiglio"},{"id":"e0c14i2qn1kk6ge","name":"Verbale Riunione di Consiglio 26-10-24"},{"id":"3462j8xln7771a6","name":"Opuscolo informativo Mensa Italia"},{"id":"h5at4oiuu3kkmeh","name":"Regolamento Sig Mensa Italia"},{"id":"320g76770590062","name":"Catalogo Boutique"},{"id":"6b76mp9i6o5f40s","name":"Regolamento CdG 2025 v5.02"},{"id":"g9iwsf9q4ik1my3","name":"Delibera CdG 2025.01 Savegnago vs Moderatori"},{"id":"t44490d72hcmse2","name":"Bilancio2024"},{"id":"59689e89064k1px","name":"Delega assemblea 2025"},{"id":"5jsyp5i9cu9837v","name":"Delibera CDG 2025.2 Consiglio Vs Gabriel Garofalo"},{"id":"441m00a9l0zf07x","name":"Delibera Consiglio vs Gabriel Garofalo - Addendum"},{"id":"vdk56nkrq8711rd","name":"Testo Mozioni Assemblea 12.04.25"},{"id":"f81a2615607ni51","name":"Relazione Contabilit?? e Saldi di Chiusura 2024"},{"id":"572voe00743507h","name":"Preventivo 2025"},{"id":"w7fbgs40sfdrkze","name":"Verbale Riunione di Consiglio 29-3-2025"},{"id":"bs9grk809a3t626","name":"Delibera Cdg 2025.04Satta vs Capannolo e Salvetti"},{"id":"70majfqk41rwy94","name":"Delibera Cdg 2025.03 Giangreco vs Giordano"},{"id":"04a0j07pza2v210","name":"Delibera CdG 2025.05 Fiorenza vs Cahoon"},{"id":"w9ro7432g54ek37","name":"Delibera CdG 2025.06 Garofalo vs Pallotti"},{"id":"5290176l8qdbf13","name":"Report Mensa App 24-25"},{"id":"2be05n17ad88945","name":"Verbale Riunione di Consiglio 1-6-25"},{"id":"lphzm627ni7344p","name":"Verbale Assemblea 12 Aprile 2025"},{"id":"3kjk11bh77sfl64","name":"Delibera CdG 2025.09 Cappalli vs Belfatto"},{"id":"72n1w48vot3ir88","name":"Delibera CdG 2025.07 Sveldezza Vs Pesce"},{"id":"1hsao7q5h5nq130","name":"Delibera Cdg 2025-08 Gaetano Buldo vs Dario Massa"},{"id":"6916400c3u3cf3i","name":"Linee Guida Consiglio 2025-2027"},{"id":"2tsk8j1351b87ow","name":"Delibera CdG 2025 -10 Consiglio Vs Silvia Giordano"},{"id":"58x8h1a979ylq0i","name":"Mille parole Paola Deon"},{"id":"kjce73h5q6ktvxw","name":"Mille parole Paolo Junior Savegnago"},{"id":"p6l20c05451037n","name":"Mille parole Alberto Jason Pallotti"},{"id":"mr3ll1ii29hj1e1","name":"Mille parole Amedeo Mela"},{"id":"yonjb4hgtlw1v6v","name":"Mille parole Alfredo Arolchi"},{"id":"310h0hj9pj7l1p1","name":"Mille parole Viviana Fusetti"},{"id":"fs3u5mv11juktao","name":"Mille parole Stefano Balocco"},{"id":"5c0t3aiolvsxvf8","name":"Mille parole Gaia Satta"},{"id":"5ej56n6eo395jvp","name":"Programma Elettorale Pallotti-Savegnago"},{"id":"rw1q36c7l517qe7","name":"DeliberaCdG2025.10a addendum - ConsiglioVSGiordano"},{"id":"b0z1812rs7lr3z8","name":"Riunione di Consiglio 28-10-2025"},{"id":"p0lsh10440art95","name":"2025.11.01 - Verbale Riunione di Consiglio"},{"id":"1621tfoy99cizkk","name":"2025.11.03 - Verbale Riunione di Consiglio"},{"id":"exau359a2n6kdam","name":"2025.11.16 - Verbale Elezioni Emilia Romagna"},{"id":"a319794fq23z13x","name":"2025.11.17 - Verbale Riunione di Consiglio"},{"id":"x349m9umsl98p53","name":"2025.12.06 - Verbale Riunione di Consiglio"},{"id":"deie7521j9fuut5","name":"Delibera CdG 2025-11 Zonno vs Bianchini"},{"id":"t6q0330t1z28jgq","name":"Delibera CdG 2025-12 Babici vs Sipione"},{"id":"4c9gsrmgx99n708","name":"Delibera CdG 2025-13 Sipione vs Babici"},{"id":"9cscn455ocddpd9","name":"Regolamento dei Gruppi Locali - Rev. 2025.12.15"},{"id":"38m13ptae92m78q","name":"Regolamento CdG - 2025 - v5.03"}],"page":1,"perPage":1000,"totalItems":-1,"totalPages":-1}
---------
individua quali documenti sono citati nel documento {nameFile}`

func FindTree(file *filesystem.File) DocumentsCitationList {
	ctx := context.Background()
	client, _ := genai.NewClient(ctx, &genai.ClientConfig{
		APIKey:  env.GetGeminiKey(),
		Backend: genai.BackendGeminiAPI,
	})

	open, err := file.Reader.Open()
	if err != nil {
		return nil
	}
	data, err := io.ReadAll(open)
	if err != nil {
		return nil
	}

	uploaded := prepareFile(client, file.Name, data)
	if uploaded == nil {
		log.Fatal("upload to Gemini failed")
	}

	contents := []*genai.Content{
		{
			Role: genai.RoleUser,
			Parts: []*genai.Part{
				genai.NewPartFromFile(*uploaded),
				genai.NewPartFromText(strings.ReplaceAll(provaPrompt, "{nameFile}", file.Name)),
			},
		},
	}

	config := &genai.GenerateContentConfig{
		ThinkingConfig: &genai.ThinkingConfig{
			ThinkingLevel: genai.ThinkingLevelHigh,
		},
		ResponseMIMEType: "application/json",
		ResponseSchema: &genai.Schema{
			Type:     genai.TypeObject,
			Required: []string{"documents_list"},
			Properties: map[string]*genai.Schema{
				"documents_list": &genai.Schema{
					Type: genai.TypeArray,
					Items: &genai.Schema{
						Type:     genai.TypeObject,
						Required: []string{"id", "name"},
						Properties: map[string]*genai.Schema{
							"id": &genai.Schema{
								Type: genai.TypeString,
							},
							"name": &genai.Schema{
								Type: genai.TypeString,
							},
						},
					},
				},
			},
		},
	}

	result, err := client.Models.GenerateContent(
		ctx,
		"gemini-3-flash-preview",
		contents,
		config,
	)

	if err != nil {
		log.Fatal(err)
	}

	var responseCitation documentsCitationResponse
	_ = json.Unmarshal([]byte(result.Text()), &responseCitation)

	log.Println(responseCitation)

	return responseCitation.Items
}
